--- 

일반적인 모듈화 페턴

모듈화의 법칙

낮은 결합력
높은 응집력
이 법칙은 모듈을 얼마나 어떻게 범주화를 해서 나눌지 정할때의 기준이 된다.
그리고 이 법칙은 비교적 큰 모듈 뿐 아니라 더 작은 패키지, 클래스, 파일, 함수 등에서도 적용된다. 

낮은 결합력은  

모듈끼리 최대한 독립적이여야한다는것이고 
독립적이라는것은 서로끼리의 참조가 적다는것(모듈끼리의 의존성이 적다는것), 수정의 전이가 없다는것이다

낮은 결합력을 만드는 방법은 모듈이 하나의 액터만 책임지는것, 객체간의 직접참조를 줄이는것
다른모듈의 데이터를 직접 변경할수 없도록 하는것 DIP를 구현하는것

여기서 DIP를 구현하면 좋은점

DIP를 구현하면 위(상위모듈)에서 아래(하위모듈)로 흐르는 연쇠적인 의존성을 끊을수 있다 
연쇠적인 의존성이 있으면 수정(변경)의 전이가 이어져서 유지보수하기 힘들어진다

높은 응집력은 

하나의 모듈의 기능들이 얼마나 관련되어있는지를 나타낸다

높은 응집력을만드는 방법은 관련된 데이터, 기능을 묶어야한다,
다른말로 같은 라이브러리를 쓰는 기능들끼리 묶기, 코드를 짤때 알아야하는것이 비슷한것들끼리 묶기, 서로 자주 상호작용하는것끼리 묶기, 모듈의 컨셉을 확실하게 하기가 있을거같다

구글 권장 아키텍처를 사용할떄 모듈 유형은 여러가지가 있다

데이터 모듈

일반적으로 Repository, DataSource, DataClass 등으로 구성되고
repository를 데이터 모듈의 유일한 진입점으로 사용한다
나머지는 internal, private 키워드로 숨긴다

기능 모듈

일반적으로 한 화면과 그 화면의상태 관리자(보통 ViewModel)로 구성된다
일반적으로 데이터 모듈에 종속적이다

앱 모듈

앱의 진입점이고 보통 네비게이션을 설정하고
기능모듈에 종속적이다

테스트 모듈

테스트만을 위한 모든 코드들이 있고 
거대한 코드베이스의 테스트를 쉽게 만들어준다 

모듈간 통신

모듈간의 직접적인 양방향 통신은 권장되지 않는다(순환참조때문에) 그래서 다른 모듈에 의존해서 통신하는데
보통 기능모듈이 서로 통신할때 앱모듈의 네비게이션을 이용해서 통신한다 
또 savedStateHandle를 사용해서도 통신할수 있다

그리고 많은 모듈끼리의 의존성 버전을 일관되게 하기 위해서 버전 카탈로그, BuildSrc 같은 방법을 사용할수 있다
모듈 단위에서 세부 구현은 외부에서 접근 제어자를 통해서 접근할수 없도록 하는것이 좋다

그리고 모듈끼리의 의존성을 설정할때 api보다 implementation을 권장한다
api와 implementation은 Gradle의 종속성 선언 키워드로, 모듈이나 라이브러리를 추가할 때 어떤 방식으로 의존성을 노출할지를 결정하는데
둘의 차이는
- `implementation`: 현재 모듈에서는 사용 가능하지만, **이 모듈을 참조하는 다른 모듈에는 노출되지 않음**  
- `api`: 현재 모듈에서 사용 가능하고, **이 모듈을 참조하는 다른 모듈도 사용할 수 있음**
이다

또한 Kotlin 및 Java 모듈 을 사용할수 있으면 최대한 사용하는것이 좋은데  
그 이유는 Android 라이브러리 모듈은 Android 빌드 시스템을 따르므로 빌드 시간이 오래 걸리지만 
Kotlin/Java 모듈은 컴파일과정만 거침으로 빌드가 빠르다 또한 순수 java, kotlin 코드이므로 여려 프로젝트에서도 사용할수 있다

| 모듈 유형 | 설명 | 출력물 |
|-----------|-------------------------------------------------|-----------|
| **앱 모듈** | 애플리케이션의 진입점. `AndroidManifest.xml`, 리소스, 소스 코드 포함 | `.apk`, `.aab` |
| **라이브러리 모듈** | 다른 Android 모듈에서 재사용 가능. UI 및 리소스 포함 가능 | `.aar` |
| **Kotlin/Java 라이브러리 모듈** | 순수 Kotlin/Java 코드만 포함. 리소스 없음 | `.jar`, `.aar` |


## 언제 Android 라이브러리 모듈(AAR)을 사용할까
| 상황 | 모듈 유형 |
|------|-----------|
| UI, 레이아웃, Drawable 리소스 포함 | **Android 라이브러리 모듈 (`.aar`)** |
| 공통 비즈니스 로직, 네트워크, 데이터 파싱 | **Kotlin/Java 라이브러리 (`.jar`)** |
